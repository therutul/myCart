<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="./assets/libs/prismjs/themes/prism-okaidia.min.css" />
    <link rel="shortcut icon" type="image/x-icon" href="./assets/images/favicon/favicon.ico" />
    <!-- Libs CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" />
    <link rel="stylesheet" href="./assets/libs/simplebar/dist/simplebar.min.css" />
    <!-- Theme CSS -->
    <link rel="stylesheet" href="./assets/css/theme.min.css">
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content="Documentation - TailwindCSS HTML Admin Template Free - Dash UI" />
    <title>Documentation - TailwindCSS HTML Admin Template Free - Dash UI</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <link  href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet"> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script> -->
  </head>
  <body>
    <main>
      <!-- start introduction -->
      <!-- app layout -->
      <div id="app-layout" class="overflow-x-hidden flex">
        <!-- start navbar -->
        <%-include('sidebar')-%>
        <!--end of navbar-->
        <!-- app layout content -->
        <div id="app-layout-content" class="min-h-screen w-full min-w-[100vw] md:min-w-0 ml-[15.625rem] [transition:margin_0.25s_ease-out]">
          <!-- start navbar -->
          <%-include('header')-%>
          <!-- end of navbar -->

          <div class="p-6">
            <h4 class="mb-4">Edit Product</h4>
            <div class="card shadow">
              <div class="card-body">
                <form action="./edit-product" method="post" enctype="multipart/form-data">
                  <div class="grid grid-cols-2 gap-6">
                    <div class="">
                      <label class="block text-gray-800">Product Name</label>
                      <input type="hidden" name="productId" value="<%=getProducts._id%>">
                      <input value="<%=getProducts.productName%>" autocomplete="off" name="productName" placeholder="Enter Product Name" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Code</label>
                      <input value="<%=getProducts.productCode%>"  autocomplete="off" name="productCode" placeholder="Enter Product Code" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="md:col-span-2">
                      <div class="card bg-green-200">
                        <div class="card-body">
                          <!-- <label class="block text-gray-800">Product Images</label> -->
                          <!-- <input  autocomplete="off" name="productImages" placeholder="Select Product Images" type="file" multiple class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" /> -->
                          <div class="flex mt-2 gap-6">
                            <div class="image1">
                              <img style="width: 256px; height: 256px;" src="/productimg/<%=getProducts.productImages[0]%>" alt="">
                              <input  autocomplete="off" name="productImg1" placeholder="Select Product Image" type="file" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                            </div>
                            <div class="image2">
                              <img style="width: 256px; height: 256px;" src="/productimg/<%=getProducts.productImages[1]%>" alt="">
                              <input  autocomplete="off" name="productImg2" placeholder="Select Product Image" type="file" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                            </div>
                            <div class="image3">
                              <img style="width: 256px; height: 256px;" src="/productimg/<%=getProducts.productImages[2]%>" alt="">
                              <input  autocomplete="off" name="productImg3" placeholder="Select Product Image" type="file" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                            </div>
                            <div class="image4">
                              <img style="width: 256px; height: 256px;" src="/productimg/<%=getProducts.productImages[3]%>" alt="">
                              <input  autocomplete="off" name="productImg4" placeholder="Select Product Image" type="file" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="md:col-span-2">
                      <label class="block text-gray-800">Product Description</label>
                      <textarea rows="7" autocomplete="off" name="productDescription" placeholder="Enter Product Description" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" ><%=getProducts.productDescription%></textarea>
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Category</label>
                      <select id="catType" name="productCategory" class="mt-2 py-2 px-4 pe-9 block w-full border-gray-300 rounded focus:border-indigo-600 text-gray-900 focus:ring-indigo-600 disabled:opacity-50 disabled:pointer-events-none" autocomplete="off">
                        <option>Select Product Category</option>
                        <%renderCategory.forEach(category=>{%>
                          <option value="<%= category._id %>" <%= category._id.toString() == selectedCategoryId ? 'selected' : '' %>><%= category.categoryName %></option>
                        <%})%>
                      </select>
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Price</label>
                      <input value="<%=getProducts.productPrice%>" autocomplete="off" name="productPrice" placeholder="Enter Product Price" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Discount (%)</label>
                      <input value="<%=getProducts.productDiscount%>" autocomplete="off" name="productDiscount" placeholder="Enter Product Discount" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Stock</label>
                      <input value="<%=getProducts.productStock%>" autocomplete="off" name="productStock" placeholder="Enter Product Stock" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Type</label>
                      
                      <select id="viewType" autocomplete="off" name="productType" class="text-gray-900 mt-5 py-2 px-4 pe-9 block w-full border-gray-300 rounded focus:border-indigo-600 focus:ring-indigo-600 disabled:opacity-50 disabled:pointer-events-none">
                        <option value="<%=getProducts.productType._id%>" selected><%=getProducts.productType.type%></option>
                        
                      </select>
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product MFG Date</label>
                      <input value="<%=new Date(getProducts.productMfg).toISOString().slice(0,10)%>" autocomplete="off" name="productMfg" placeholder="Enter Product MFG Date" type="date" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Expiry Date</label>
                      <input value="<%= new Date(getProducts.productExpiry).toISOString().slice(0, 10) %>" autocomplete="off" name="productExpiry" placeholder="Enter Product Expiry Date" type="date" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                    <div class="">
                      <label class="block text-gray-800">Product Tags</label>
                      <input value="<%=getProducts.productTags%>" autocomplete="off" name="productTags" placeholder="Enter Product Tags" type="text" class="mt-2 border border-gray-300 text-gray-900 rounded focus:ring-indigo-600 focus:border-indigo-600 block w-full p-2 px-3 disabled:opacity-50 disabled:pointer-events-none" />
                    </div>
                  </div>
                  <div class="flex items-center gap-2 mt-4">
                    <input value="Edit Product" id="addCategory" type="submit" class="btn w-44 gap-x-2 bg-teal-600 text-white border-teal-600 disabled:opacity-50 disabled:pointer-events-none hover:text-white hover:bg-teal-700 hover:border-teal-700 active:bg-teal-700 active:border-teal-700 focus:outline-none focus:ring-4 focus:ring-teal-300">
                    <div class="animate-spin hidden w-4 h-4 border-[3px] border-current border-t-transparent text-green-600 rounded-full " role="status" aria-label="loading">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <% if (success_messages.length > 0) { %>
                      <div class="bg-teal-200 flex items-center w-full text-gray-900 rounded-lg px-4 py-2 alert" role="alert">
                        <span><span class="font-bold">Success:</span> <%= success_messages[0] %></span>
                        <button type="button" class="btn-close ms-auto -mx-1.5 -my-1.5 text-gray-900 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 " data-bs-dismiss="alert" aria-label="Close">
                          <span class="sr-only">Close</span>
                          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                          </svg>
                        </button>
                      </div>
                    <% } %>
                    <% if (error_messages.length > 0) { %>
                      <div class="bg-red-200 flex items-center w-full text-gray-900 rounded-lg px-4 py-2 alert" role="alert">
                        <span><span class="font-bold">Error:</span> <%= error_messages[0] %></span>
                        <button type="button" class="btn-close ms-auto -mx-1.5 -my-1.5 text-gray-900 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 " data-bs-dismiss="alert" aria-label="Close">
                          <span class="sr-only">Close</span>
                          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                          </svg>
                        </button>
                      </div>
                    <% } %>
                  </div>
                  
        
                  
                  </form>
              </div>
            </div>
          </div>
          <%-include('footer')-%>
        </div>
      </div>
      <!-- end of introduction -->
    </main>
    <!-- Libs JS -->
    <script src="./assets/libs/feather-icons/dist/feather.min.js"></script>
    <script src="./assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/libs/simplebar/dist/simplebar.min.js"></script>
    <!-- Theme JS -->
    <script src="./assets/js/theme.min.js"></script>
    <script src="./assets/libs/prismjs/prism.js"></script>
    <script src="./assets/libs/prismjs/components/prism-scss.min.js"></script>
    <script src="./assets/libs/prismjs/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="./assets/libs/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script>
      $(document).ready(function() {
        $("#catType").change(function() {
          $.ajax({
              url: "/admin/viewtype",
              method: "POST",
              data: {
                  productCategory: $("#catType").val()
              },
              success: function(data) {
                  $("#viewType").empty();
                  $("#viewType").append("<option selected>Select Product Type</option>")
                  // Append new options based on the fetched data
                  data.forEach(type=> {
                    $("#viewType").append(`<option value=${type._id}>${type.type}</option>`);
                  }); 
                  console.log(data);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                  console.error("AJAX Error:", textStatus, errorThrown);
                  // Display an error message to the user (optional)
                  $("#viewType").html("Error loading view type. Please try again.");
              }
          });
        });

      });

    </script>
  </body>
</html>